<!DOCTYPE HTML>
<html layout:decorate="~{layout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{deal.list.headline}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
<div layout:fragment="content">
    <div class="d-flex flex-wrap mb-4">
        <h1 class="flex-grow-1" th:text="#{deal.list.headline}" />
        <div sec:authorize="isAuthenticated()">
            <div sec:authorize="hasRole('ROLE_ADMIN')">
                <a class="btn btn-primary ms-2" th:href="@{/deals/add}" th:text="#{deal.list.createNew}" />
            </div>
        </div>
    </div>
    <div th:if="${deals.empty}" th:text="#{deal.list.empty}" />
    <div class="table-responsive" th:if="${!deals.empty}">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col" th:text="#{deal.days.label}" />
                    <th scope="col" th:text="#{deal.description.label}" />
                    <th scope="col" th:text="#{deal.place.label}" />
                    <th scope="col" th:text="#{deal.price.label}" />
                    <th scope="col" th:text="#{deal.discount.label}" />
                    <th scope="col" th:text="#{deal.discountPercent.label}" />
                    <th sec:authorize="isAuthenticated()"><!-- --></th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="deal : ${deals}">
                    <td class="text-nowrap" th:text="${deal.daysDisplay}"/>
                    <td>
                        <i class="bi bi-check-circle" th:if="${deal.isVerified}" th:title="#{verified}"></i>
                        <span th:text="${deal.description}"/>
                    </td>
                    <td th:text="${deal.placeName}" />
                    <td th:text="${deal.priceRange}" />
                    <td th:text="${deal.discountRange}" />
                    <td th:text="${deal.discountPercentRange}" />
                    <td sec:authorize="isAuthenticated()" style="white-space:nowrap">
                        <a class="btn btn-sm btn-info" th:href="@{/deals/edit/{id}(id=${deal.id})}"
                           th:unless="${#strings.contains(#authentication.principal.authorities, 'ROLE_ADMIN')}">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <form class="js-submit-confirm float-end"
                              method="post" th:action="@{/deals/delete/{id}(id=${deal.id})}"
                              th:data-confirm-message="#{delete.confirm}"
                              th:if="${#strings.contains(#authentication.principal.authorities, 'ROLE_ADMIN')}">
                            <a class="btn btn-sm btn-info" th:href="@{/deals/edit/{id}(id=${deal.id})}">
                                <i class="bi bi-pencil"></i>
                            </a>
                            <button class="btn btn-sm btn-danger" type="submit"><i class="bi bi-trash"></i></button>
                        </form>
                    </td>
                </tr>
        </tbody>
    </table>
</div>
</div>
</body>
</html>
